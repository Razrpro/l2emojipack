import os
import re

def get_emoji_for_filename(filename):
    """
    ะะพะดะฑะธัะฐะตั ัะผะพะดะทะธ ะฝะฐ ะพัะฝะพะฒะต ัะพะดะตัะถะฐะฝะธั ะฝะฐะทะฒะฐะฝะธั ัะฐะนะปะฐ.
    """
    # ะฃะฑะธัะฐะตะผ ัะฐััะธัะตะฝะธะต ะดะปั ะฐะฝะฐะปะธะทะฐ
    name_lower = filename.lower().replace('.png', '').replace('.jpg', '').replace('.jpeg', '')
    
    # ะกะปะพะฒะฐัั ะบะปััะตะฒัั ัะปะพะฒ ะธ ัะพะพัะฒะตัััะฒัััะธั ัะผะพะดะทะธ
    emoji_map = {
        # ะััะถะธะต
        'sword|ะผะตั|blade': 'โ๏ธ',
        'bow|ะปัะบ': '๐น',
        'dagger|ะบะธะฝะถะฐะป': '๐ก๏ธ',
        'staff|ะฟะพัะพั': '๐ช',
        'weapon|ะพััะถะธะต': 'โ๏ธ',
        'shield|ัะธั': '๐ก๏ธ',
        'slasher|cutter': '๐ช',
        'spear|ะบะพะฟัะต': '๐ฑ',
        'gun|shooter': '๐ซ',
        'fist|ะบัะปะฐะบ': '๐',
        'katana': 'โ๏ธ',
        'rapier': '๐ก๏ธ',
        
        # ะะฐะณะธั ะธ ัััะตะบัั
        'crystal|ะบัะธััะฐะปะป': '๐',
        'scroll|ัะฒะธัะพะบ': '๐',
        'potion|ะทะตะปัะต': '๐งช',
        'magic|ะผะฐะณะธั': 'โจ',
        'spell|ะทะฐะบะปะธะฝะฐะฝะธะต': 'โจ',
        'enchant|ะทะฐัะฐัะพะฒะฐะฝะธะต': 'โจ',
        'rune|ััะฝะฐ': '๐ฎ',
        'soul|ะดััะฐ': '๐ป',
        'fire|ะพะณะพะฝั|flame': '๐ฅ',
        'ice|ะปะตะด|frozen': 'โ๏ธ',
        'water|ะฒะพะดะฐ': '๐ง',
        'wind|ะฒะตัะตั': '๐จ',
        'earth|ะทะตะผะปั': '๐',
        'lightning|ะผะพะปะฝะธั': 'โก',
        'holy|ัะฒััะพะน': 'โ๏ธ',
        
        # ะัะตะดะผะตัั ะธ ัะตััััั
        'coin|ะผะพะฝะตัะฐ|adena': '๐ฐ',
        'gold|ะทะพะปะพัะพ': '๐ช',
        'box|ััะธะบ|ััะฝะดัะบ|chest': '๐ฆ',
        'ticket|ะฑะธะปะตั|ะบัะฟะพะฝ': '๐ซ',
        'book|ะบะฝะธะณะฐ': '๐',
        'stone|ะบะฐะผะตะฝั': '๐ชจ',
        'gem|ะดัะฐะณะพัะตะฝะฝัะน': '๐',
        'jewel|ัะบัะฐัะตะฝะธะต': '๐',
        'bead|ะฑััะธะฝะฐ': '๐ฟ',
        'piece|ะบััะพะบ|ะพัะบะพะปะพะบ|fragment': '๐งฉ',
        'ore|ััะดะฐ': 'โ๏ธ',
        'feather|ะฟะตัะพ': '๐ชถ',
        'powder|ะฟะพัะพัะพะบ': '๐',
        'bottle|ะฑัััะปะบะฐ': '๐พ',
        'pouch|ะผะตัะพะบ': '๐',
        
        # ะะบัะตัััะฐัั
        'ring|ะบะพะปััะพ': '๐',
        'earring|ัะตััะณะฐ': '๐',
        'necklace|ะพะถะตัะตะปัะต': '๐ฟ',
        'bracelet|ะฑัะฐัะปะตั': '๐ฟ',
        'talisman|ัะฐะปะธัะผะฐะฝ': '๐งฟ',
        'brooch|ะฑัะพัั': '๐',
        'accessory|ะฐะบัะตัััะฐั': '๐',
        'cap|ัะฐะฟะบะฐ': '๐ฉ',
        'mask|ะผะฐัะบะฐ': '๐ญ',
        'helmet|ัะปะตะผ': 'โ๏ธ',
        
        # ะะพัะฟะตัะธ ะธ ะพะดะตะถะดะฐ
        'armor|ะดะพัะฟะตั': '๐ก๏ธ',
        'cloak|ะฟะปะฐั': '๐งฅ',
        'clothes|ะพะดะตะถะดะฐ|ะฝะฐััะด': '๐',
        'suit|ะบะพัััะผ': '๐ฆบ',
        
        # ะกััะตััะฒะฐ ะธ ะฑะพััั
        'dragon|ะดัะฐะบะพะฝ': '๐',
        'wolf|ะฒะพะปะบ': '๐บ',
        'doll|ะบัะบะปะฐ': '๐',
        'agathion': '๐พ',
        'beast|ะทะฒะตัั': '๐ฆ',
        'elemental|ัะปะตะผะตะฝัะฐะปั': '๐',
        'demon|ะดะตะผะพะฝ': '๐ฟ',
        'angel|ะฐะฝะณะตะป': '๐ผ',
        'ghost|ะฟัะธะทัะฐะบ': '๐ป',
        'king|ะบะพัะพะปั': '๐',
        'queen|ะบะพัะพะปะตะฒะฐ': '๐',
        
        # ะกะธะผะฒะพะปั ะธ ะทะฝะฐะบะธ
        'star|ะทะฒะตะทะดะฐ': 'โญ',
        'flag|ัะปะฐะณ': '๐ฉ',
        'cube|ะบัะฑ': '๐ฒ',
        'mark|ะทะฝะฐะบ': 'โ',
        'seal|ะฟะตัะฐัั': '๐ฑ',
        'sigil': '๐ฑ',
        'contract|ะบะพะฝััะฐะบั': '๐',
        'card|ะบะฐััะฐ': '๐',
        
        # ะะดะฐ ะธ ะฟัะฐะทะดะฝะธะบะธ
        'cake|ัะพัั': '๐',
        'candy|ะบะพะฝัะตัะฐ': '๐ฌ',
        'cookie': '๐ช',
        'chocolate|ัะพะบะพะปะฐะด': '๐ซ',
        'rose|ัะพะทะฐ': '๐น',
        'valentine': '๐',
        'wedding|ัะฒะฐะดัะฑะฐ': '๐',
        'christmas|santa|rudolf': '๐',
        'birthday': '๐',
        
        # ะัะพะฑัะต ะฟัะตะดะผะตัั
        'dice|ะบะพััั': '๐ฒ',
        'time|ะฒัะตะผั': 'โฐ',
        'dimension|ะธะทะผะตัะตะฝะธะต': '๐',
        'portal': '๐',
        'tower|ะฑะฐัะฝั': '๐ผ',
        'temple|ััะฐะผ': 'โฉ๏ธ',
        'grail|ะณัะฐะฐะปั': '๐',
        'trophy|ััะพัะตะน': '๐',
        'energy|ัะฝะตัะณะธั': 'โก',
        'power|ัะธะปะฐ': '๐ช',
        'blessing|ะฑะปะฐะณะพัะปะพะฒะตะฝะธะต|ะฑะปะฐะณ': '๐',
        'cursed|ะฟัะพะบะปัััะน': '๐',
        
        # ะะตะนััะฒะธั ะธ ััะฐัััั
        'exp|ะพะฟัั': '๐',
        'level|ััะพะฒะตะฝั': '๐',
        'pvp': 'โ๏ธ',
        'pve': '๐ฏ',
        'skill|ะฝะฐะฒัะบ|ัะบะธะปะป': '๐ฏ',
        'buff': '๐ช',
        'debuff': '๐',
        'heal|ะปะตัะตะฝะธะต': '๐',
        'defense|ะทะฐัะธัะฐ': '๐ก๏ธ',
        'attack|ะฐัะฐะบะฐ': 'โ๏ธ',
        
        # ะะฐะทะฝะพะต
        'event|ัะพะฑััะธะต': '๐',
        'reward|ะฝะฐะณัะฐะดะฐ': '๐',
        'gift|ะฟะพะดะฐัะพะบ': '๐',
        'special|ะพัะพะฑัะน': 'โญ',
        'premium': '๐',
        'royal|ะบะพัะพะปะตะฒัะบะธะน': '๐',
        'hero|ะณะตัะพะน': '๐ฆธ',
        'immortal|ะฑะตััะผะตััะฝัะน': 'โพ๏ธ',
        'ancient|ะดัะตะฒะฝะธะน': '๐๏ธ',
        'mystery|ัะฐะนะฝะฐ': 'โ',
        'random': '๐ฒ',
        'transform|ััะฐะฝััะพัะผะฐัะธั': '๐',
        'renewal|ะพะฑะฝะพะฒะปะตะฝะธะต': '๐',
        'ัะฐะผััะฐะน': '๐ฅท',
        'pirate|ะฟะธัะฐั': '๐ดโโ๏ธ',
        'ัะพัะบะฐ': 'โซ',
        'ัะฒะตัะพั': '๐ฆ',
    }
    
    # ะัะตะผ ะฟะพะดัะพะดััะธะน ัะผะพะดะทะธ
    for pattern, emoji in emoji_map.items():
        if re.search(pattern, name_lower):
            return emoji
    
    # ะะตัะพะปัะฝัะน ัะผะพะดะทะธ, ะตัะปะธ ะฝะธัะตะณะพ ะฝะต ะฟะพะดะพัะปะพ
    return 'โญ'

def rename_files_with_emoji(folder='img_resized'):
    """
    ะะตัะตะธะผะตะฝะพะฒัะฒะฐะตั ะฒัะต ัะฐะนะปั ะฒ ะฟะฐะฟะบะต, ะทะฐะผะตะฝัั ะธะผั ะฝะฐ ัะผะพะดะทะธ.
    """
    if not os.path.exists(folder):
        print(f"ะะฐะฟะบะฐ '{folder}' ะฝะต ะฝะฐะนะดะตะฝะฐ")
        return
    
    # ะะพะปััะฐะตะผ ัะฟะธัะพะบ ะฒัะตั ัะฐะนะปะพะฒ
    files = [f for f in os.listdir(folder) if os.path.isfile(os.path.join(folder, f))]
    image_files = [f for f in files if f.lower().endswith(('.png', '.jpg', '.jpeg', '.gif', '.bmp', '.webp', '.tiff'))]
    
    if not image_files:
        print(f"ะ ะฟะฐะฟะบะต '{folder}' ะฝะต ะฝะฐะนะดะตะฝะพ ะธะทะพะฑัะฐะถะตะฝะธะน")
        return
    
    print(f"ะะฐะนะดะตะฝะพ ะธะทะพะฑัะฐะถะตะฝะธะน: {len(image_files)}")
    print(f"ะะฐัะธะฝะฐั ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธะต...\n")
    
    # ะกัะตััะธะบ ะดะปั ะพะดะธะฝะฐะบะพะฒัั ัะผะพะดะทะธ
    emoji_counter = {}
    renamed_count = 0
    
    for i, filename in enumerate(sorted(image_files), 1):
        try:
            # ะะพะปััะฐะตะผ ัะฐััะธัะตะฝะธะต ัะฐะนะปะฐ
            _, ext = os.path.splitext(filename)
            
            # ะะพะปััะฐะตะผ ะฟะพะดัะพะดััะธะน ัะผะพะดะทะธ
            emoji = get_emoji_for_filename(filename)
            
            # ะัะปะธ ัะฐะบะพะน ัะผะพะดะทะธ ัะถะต ะฑัะป, ะดะพะฑะฐะฒะปัะตะผ ะฝะพะผะตั
            if emoji in emoji_counter:
                emoji_counter[emoji] += 1
                new_name = f"{emoji}{emoji_counter[emoji]}{ext}"
            else:
                emoji_counter[emoji] = 1
                new_name = f"{emoji}{ext}"
            
            # ะะพะปะฝัะต ะฟััะธ
            old_path = os.path.join(folder, filename)
            new_path = os.path.join(folder, new_name)
            
            # ะัะปะธ ัะฐะนะป ั ัะฐะบะธะผ ะธะผะตะฝะตะผ ัะถะต ัััะตััะฒัะตั, ะดะพะฑะฐะฒะปัะตะผ ะธะฝะดะตะบั
            counter = 1
            while os.path.exists(new_path):
                new_name = f"{emoji}_{counter}{ext}"
                new_path = os.path.join(folder, new_name)
                counter += 1
            
            # ะะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ
            os.rename(old_path, new_path)
            renamed_count += 1
            
            print(f"[{i}/{len(image_files)}] {filename[:50]:<50} โ {new_name}")
            
        except Exception as e:
            print(f"[{i}/{len(image_files)}] {filename} - ะพัะธะฑะบะฐ: {e}")
    
    print(f"\nโ ะะพัะพะฒะพ! ะะตัะตะธะผะตะฝะพะฒะฐะฝะพ ัะฐะนะปะพะฒ: {renamed_count}/{len(image_files)}")
    print(f"๐ ะัะฟะพะปัะทะพะฒะฐะฝะพ ัะฝะธะบะฐะปัะฝัั ัะผะพะดะทะธ: {len(emoji_counter)}")

if __name__ == "__main__":
    rename_files_with_emoji()
